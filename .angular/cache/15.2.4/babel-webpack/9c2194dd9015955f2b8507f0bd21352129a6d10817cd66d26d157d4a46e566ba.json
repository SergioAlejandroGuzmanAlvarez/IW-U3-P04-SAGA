{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/producto.service\";\nimport * as i2 from \"../services/category.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"ion-rating-stars\";\nconst _c0 = [\"ionBusqueda\"];\nfunction Tab2Page_ion_col_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-col\", 8)(1, \"ion-card\", 9);\n    i0.ɵɵlistener(\"click\", function Tab2Page_ion_col_12_Template_ion_card_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const prod_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.setActiveProd(prod_r4));\n    });\n    i0.ɵɵelement(2, \"img\", 10);\n    i0.ɵɵelementStart(3, \"ion-card-header\")(4, \"ion-card-title\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"ion-card-subtitle\", 11);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"ion-card-content\")(9, \"ion-grid\", 2)(10, \"ion-row\")(11, \"ion-col\", 12)(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(14, \"ion-row\")(15, \"ion-col\", 3);\n    i0.ɵɵelement(16, \"ion-rating-stars\", 13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"ion-row\")(18, \"ion-col\", 3)(19, \"h2\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"ion-col\", 8)(22, \"label\", 14);\n    i0.ɵɵlistener(\"click\", function Tab2Page_ion_col_12_Template_label_click_22_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.setModalUnoOpen(true));\n    });\n    i0.ɵɵtext(23, \"Calificar\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(24, \"ion-row\")(25, \"ion-col\", 12)(26, \"ion-button\", 15);\n    i0.ɵɵlistener(\"click\", function Tab2Page_ion_col_12_Template_ion_button_click_26_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.setModalDosOpen(true));\n    });\n    i0.ɵɵelement(27, \"ion-icon\", 16);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(28, \"ion-grid\", 2)(29, \"ion-row\")(30, \"ion-col\", 3)(31, \"ion-chip\", 17)(32, \"ion-label\", 18);\n    i0.ɵɵtext(33);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(34, \"ion-col\", 8)(35, \"ion-chip\", 19)(36, \"label\");\n    i0.ɵɵtext(37, \"STOCK\");\n    i0.ɵɵelementEnd()()()()()()()();\n  }\n  if (rf & 2) {\n    const prod_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"alt\", prod_r4.name);\n    i0.ɵɵpropertyInterpolate(\"src\", prod_r4.photo, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(prod_r4.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"$\", prod_r4.price, \"\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(prod_r4.description);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"rating\", ctx_r1.getPromCal(prod_r4.calification).promedio)(\"color\", \"darkgrey\")(\"filledColor\", \"orange\")(\"margin\", 2)(\"size\", 25)(\"disabled\", true);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.getPromCal(prod_r4.calification).cantidad);\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"color\", ctx_r1.getColor(prod_r4.category.idCategoryBK));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(prod_r4.category.idCategoryBK);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"color\", ctx_r1.getColorStock(prod_r4.stock));\n  }\n}\nfunction Tab2Page_ng_template_14_ng_container_16_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const val_r10 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", val_r10.message, \" \");\n  }\n}\nfunction Tab2Page_ng_template_14_ng_container_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, Tab2Page_ng_template_14_ng_container_16_div_1_Template, 2, 1, \"div\", 28);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const val_r10 = ctx.$implicit;\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    let tmp_0_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_0_0 = ctx_r9.formCalif.get(\"calification\")) == null ? null : tmp_0_0.hasError(val_r10.type)) && ((tmp_0_0 = ctx_r9.formCalif.get(\"calification\")) == null ? null : tmp_0_0.touched));\n  }\n}\nfunction Tab2Page_ng_template_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-buttons\", 20)(5, \"ion-button\", 9);\n    i0.ɵɵlistener(\"click\", function Tab2Page_ng_template_14_Template_ion_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.setModalUnoOpen(false));\n    });\n    i0.ɵɵtext(6, \"Close\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(7, \"ion-content\", 21)(8, \"form\", 22)(9, \"ion-list\")(10, \"ion-item\");\n    i0.ɵɵelement(11, \"ion-input\", 23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"ion-item\");\n    i0.ɵɵelement(13, \"ion-input\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"ion-item\");\n    i0.ɵɵelement(15, \"ion-input\", 25);\n    i0.ɵɵtemplate(16, Tab2Page_ng_template_14_ng_container_16_Template, 2, 1, \"ng-container\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"ion-item\")(18, \"ion-button\", 27);\n    i0.ɵɵlistener(\"click\", function Tab2Page_ng_template_14_Template_ion_button_click_18_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.addCalif());\n    });\n    i0.ɵɵtext(19, \" Send \");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Qualify \", ctx_r2.activeProd[1], \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"formGroup\", ctx_r2.formCalif);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.validationMessages[\"calification\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", !ctx_r2.formCalif.valid);\n  }\n}\nfunction Tab2Page_ng_template_16_ion_list_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 32)(1, \"ion-item\")(2, \"h4\", 33);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"ion-rating-stars\", 34);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-item\", 35)(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"ion-item\", 36)(9, \"p\", 20);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const coment_r17 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(coment_r17.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"rating\", coment_r17.calification)(\"color\", \"darkgrey\")(\"filledColor\", \"orange\")(\"margin\", 2)(\"size\", 15)(\"disabled\", true);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\\"\", coment_r17.coment, \"\\\"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate3(\"Send: \", coment_r17.fecha.getDate().toString().padStart(2, \"0\"), \"/\", (coment_r17.fecha.getMonth() + 1).toString().padStart(2, \"0\"), \"/\", coment_r17.fecha.getFullYear().toString(), \"\");\n  }\n}\nfunction Tab2Page_ng_template_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-buttons\", 20)(5, \"ion-button\", 9);\n    i0.ɵɵlistener(\"click\", function Tab2Page_ng_template_16_Template_ion_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.setModalDosOpen(false));\n    });\n    i0.ɵɵtext(6, \"Close\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(7, \"ion-content\", 21);\n    i0.ɵɵtemplate(8, Tab2Page_ng_template_16_ion_list_8_Template, 11, 11, \"ion-list\", 30);\n    i0.ɵɵelementStart(9, \"ion-infinite-scroll\");\n    i0.ɵɵelement(10, \"ion-infinite-scroll-content\", 31);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Qualify \", ctx_r3.activeProd[1], \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.opiniones);\n  }\n}\nexport let Tab2Page = /*#__PURE__*/(() => {\n  class Tab2Page {\n    constructor(prodServ, cateServ, alertController, toastController, modalController, fb) {\n      this.prodServ = prodServ;\n      this.cateServ = cateServ;\n      this.alertController = alertController;\n      this.toastController = toastController;\n      this.modalController = modalController;\n      this.fb = fb;\n      this.isModalUnoOpen = false;\n      this.isModalDosOpen = false;\n      this.productos = [];\n      this.fProductos = [];\n      this.categorias = [];\n      this.opiniones = [];\n      this.formCalif = this.fb.group({});\n      this.activeProd = [];\n      this.categorias = this.cateServ.getCatego();\n      this.productos = this.prodServ.getProductos();\n      this.fProductos = this.productos;\n      this.limpiarFormulario();\n      this.validationMessages = {\n        'calification': [{\n          type: 'required',\n          message: 'Calificación requerida!'\n        }, {\n          type: 'min',\n          message: 'El minimo es cero!'\n        }, {\n          type: 'max',\n          message: 'El maximo es cinco!'\n        }]\n      };\n    }\n    limpiarFormulario() {\n      this.formCalif = this.fb.group({\n        name: [\"\"],\n        coment: [\"\"],\n        calification: [\"\", Validators.compose([Validators.required, Validators.min(0), Validators.max(5)])],\n        fecha: [new Date()]\n      });\n    }\n    getColor(type) {\n      switch (type) {\n        case 'Atrapa Sueños':\n          return 'danger';\n        case 'Mandala':\n          return 'success';\n        case 'Ojos de Dios':\n          return 'warning';\n        default:\n          return 'primary';\n      }\n    }\n    getColorStock(stock) {\n      if (stock > 0) return 'success';else return 'danger';\n    }\n    filter(dato) {\n      if (!dato.trim()) {\n        this.fProductos = this.productos;\n        return;\n      }\n      this.fProductos = this.productos.filter(prod => prod.name.toLowerCase().includes(dato.toLowerCase()));\n    }\n    filterProduct(event) {\n      if (event instanceof CustomEvent) {\n        this.filter(event.detail.value);\n      }\n    }\n    setModalUnoOpen(isOpen) {\n      this.isModalUnoOpen = isOpen;\n      if (!this.isModalUnoOpen) {\n        this.activeProd[0] = \"\";\n        this.activeProd[1] = \"\";\n      }\n    }\n    setModalDosOpen(isOpen) {\n      this.isModalDosOpen = isOpen;\n      if (!this.isModalUnoOpen) {\n        this.activeProd[0] = \"\";\n        this.activeProd[1] = \"\";\n        this.opiniones = [];\n      }\n    }\n    setActiveProd(prod) {\n      this.activeProd[0] = prod.sku;\n      this.activeProd[1] = prod.name;\n      this.opiniones = prod.calification;\n    }\n    addCalif() {\n      const pos = this.productos.findIndex(p => p.sku == this.activeProd[0]);\n      /*let calif = this.formCalif.getRawValue();\r\n      if(calif.name == '') calif.name='Anonimo';\r\n      if(calif.coment == '') calif.coment='La persona no dejó comentario';*/\n      this.productos[pos].calification.push(this.formCalif.getRawValue());\n      const _prod = this.productos[pos];\n      this.prodServ.uploadProduct(_prod);\n      this.setModalUnoOpen(false);\n      this.limpiarFormulario();\n    }\n    getPromCal(calificaciones) {\n      if (calificaciones.length === 0) {\n        return {\n          promedio: 0,\n          cantidad: 0\n        };\n      }\n      const suma = calificaciones.reduce((a, b) => a + b.calification, 0);\n      const promedio = suma / calificaciones.length;\n      return {\n        promedio,\n        cantidad: calificaciones.length\n      };\n    }\n  }\n  Tab2Page.ɵfac = function Tab2Page_Factory(t) {\n    return new (t || Tab2Page)(i0.ɵɵdirectiveInject(i1.ProductoService), i0.ɵɵdirectiveInject(i2.CategoryService), i0.ɵɵdirectiveInject(i3.AlertController), i0.ɵɵdirectiveInject(i3.ToastController), i0.ɵɵdirectiveInject(i3.ModalController), i0.ɵɵdirectiveInject(i4.FormBuilder));\n  };\n  Tab2Page.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: Tab2Page,\n    selectors: [[\"app-tab2\"]],\n    viewQuery: function Tab2Page_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.busqueda = _t.first);\n      }\n    },\n    decls: 17,\n    vars: 5,\n    consts: [[3, \"translucent\"], [3, \"fullscreen\"], [\"fixed\", \"\"], [\"size\", \"8\"], [\"placeholder\", \"Search:\", 3, \"ionChange\"], [\"ionBusqueda\", \"\"], [\"size\", \"4\", 4, \"ngFor\", \"ngForOf\"], [3, \"isOpen\"], [\"size\", \"4\"], [3, \"click\"], [\"width\", \"420\", \"height\", \"420\", 3, \"alt\", \"src\"], [\"color\", \"success\"], [\"size\", \"12\"], [3, \"rating\", \"color\", \"filledColor\", \"margin\", \"size\", \"disabled\"], [1, \"opinar-label\", 3, \"click\"], [\"fill\", \"clear\", \"size\", \"small\", 3, \"click\"], [\"name\", \"chevron-down-outline\"], [\"outline\", \"true\", 3, \"color\"], [1, \"prod-categoria\"], [3, \"color\"], [\"slot\", \"end\"], [1, \"ion-padding\"], [3, \"formGroup\"], [\"type\", \"text\", \"placeholder\", \"Nombre (opcional)\", \"formControlName\", \"name\"], [\"type\", \"text\", \"placeholder\", \"Comentario (opcional)\", \"formControlName\", \"coment\"], [\"type\", \"number\", \"placeholder\", \"Calificaci\\u00F3n (0-5)\", \"formControlName\", \"calification\"], [4, \"ngFor\", \"ngForOf\"], [\"color\", \"success\", \"expand\", \"full\", 3, \"disabled\", \"click\"], [\"class\", \"error-message\", 4, \"ngIf\"], [1, \"error-message\"], [\"class\", \"listComent\", 4, \"ngFor\", \"ngForOf\"], [\"loadingText\", \"Please wait...\", \"loadingSpinner\", \"bubbles\"], [1, \"listComent\"], [\"slot\", \"start\"], [\"slot\", \"end\", 3, \"rating\", \"color\", \"filledColor\", \"margin\", \"size\", \"disabled\"], [1, \"comentario\"], [1, \"fecha\"]],\n    template: function Tab2Page_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\")(2, \"ion-title\");\n        i0.ɵɵtext(3, \" Products \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(4, \"ion-content\", 1)(5, \"ion-grid\", 2)(6, \"ion-row\")(7, \"ion-col\", 3)(8, \"ion-searchbar\", 4, 5);\n        i0.ɵɵlistener(\"ionChange\", function Tab2Page_Template_ion_searchbar_ionChange_8_listener($event) {\n          return ctx.filterProduct($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(10, \"ion-grid\", 2)(11, \"ion-row\");\n        i0.ɵɵtemplate(12, Tab2Page_ion_col_12_Template, 38, 15, \"ion-col\", 6);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(13, \"ion-modal\", 7);\n        i0.ɵɵtemplate(14, Tab2Page_ng_template_14_Template, 20, 4, \"ng-template\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"ion-modal\", 7);\n        i0.ɵɵtemplate(16, Tab2Page_ng_template_16_Template, 11, 2, \"ng-template\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"translucent\", true);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"fullscreen\", true);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngForOf\", ctx.fProductos);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"isOpen\", ctx.isModalUnoOpen);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"isOpen\", ctx.isModalDosOpen);\n      }\n    },\n    dependencies: [i3.IonButton, i3.IonButtons, i3.IonCard, i3.IonCardContent, i3.IonCardHeader, i3.IonCardSubtitle, i3.IonCardTitle, i3.IonChip, i3.IonCol, i3.IonContent, i3.IonGrid, i3.IonHeader, i3.IonIcon, i3.IonInfiniteScroll, i3.IonInfiniteScrollContent, i3.IonInput, i3.IonItem, i3.IonLabel, i3.IonList, i3.IonRow, i3.IonSearchbar, i3.IonTitle, i3.IonToolbar, i3.IonModal, i3.NumericValueAccessor, i3.TextValueAccessor, i5.NgForOf, i5.NgIf, i4.ɵNgNoValidate, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName, i6.IonRatingStarsComponent],\n    styles: [\".error-message[_ngcontent-%COMP%]{color:red;text-align:right;padding-right:10px;font-style:italic;font-size:15px}.divContenido[_ngcontent-%COMP%]{display:flex;gap:2rem;width:100%;padding:0 4.5%}.pContenidoHijo[_ngcontent-%COMP%]{width:13%;text-align:center}.comentario[_ngcontent-%COMP%]{margin-left:30px;font-style:italic;font-size:18px}.fecha[_ngcontent-%COMP%]{font-style:italic;font-size:14px}.listComent[_ngcontent-%COMP%]{border:1px solid;margin-bottom:15px}\"]\n  });\n  return Tab2Page;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}